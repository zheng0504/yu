from app import create_app, db
from app.models.数据库模型 import 用户, 大学, 录取记录, 个人陈述, 文书模板
from datetime import datetime, timedelta
import json

app = create_app()

def 初始化数据库():
    with app.app_context():
        # 删除所有现有表
        db.drop_all()
        # 创建新表
        db.create_all()
        
        # 添加示例文书模板
        模板列表 = [
            {
                '标题': '学术背景与研究兴趣',
                '类别': '个人陈述',
                '内容': '''在我的本科学习期间，我专注于计算机科学领域，尤其对人工智能和机器学习产生了浓厚的兴趣。通过参与多个研究项目，我不仅掌握了扎实的理论知识，还积累了丰富的实践经验。

我的研究兴趣主要集中在深度学习在自然语言处理中的应用。在毕业设计中，我开发了一个基于深度学习的文本分类系统，该系统能够自动识别和分类新闻文章的主题。这个项目不仅让我深入理解了神经网络的工作原理，还培养了我解决实际问题的能力。

在贵校的研究生项目中，我希望能够进一步深化对机器学习算法的研究，特别是在自然语言处理领域。我相信，贵校优秀的师资力量和先进的研究设施将为我的学术追求提供最好的支持。''',
                '描述': '适用于计算机科学相关专业的个人陈述开头部分',
                '标签': ['计算机科学', '研究经历', '学术兴趣'],
                '是否高级模板': False
            },
            {
                '标题': '职业规划与目标',
                '类别': '个人陈述',
                '内容': '''我的长期职业目标是成为一名人工智能领域的研究员，致力于开发能够解决实际问题的智能系统。我相信，在贵校攻读硕士学位将是实现这一目标的重要一步。

通过研究生阶段的学习，我希望能够：
1. 深入研究最新的机器学习算法和技术
2. 参与前沿研究项目，积累研究经验
3. 建立学术网络，为未来的博士研究做准备

毕业后，我计划先在业界工作几年，积累实践经验，然后继续攻读博士学位。我相信，这样的规划将帮助我在理论研究和实际应用之间找到最佳平衡。''',
                '描述': '清晰的职业规划和学习目标陈述',
                '标签': ['职业规划', '学习目标', '研究计划'],
                '是否高级模板': True
            }
        ]
        
        for 模板数据 in 模板列表:
            模板 = 文书模板(
                标题=模板数据['标题'],
                类别=模板数据['类别'],
                内容=模板数据['内容'],
                描述=模板数据['描述'],
                标签=模板数据['标签'],
                是否高级模板=模板数据['是否高级模板']
            )
            db.session.add(模板)
        
        # 添加示例大学数据
        大学列表 = [
            {
                '名称': '麻省理工学院',
                '英文名称': 'Massachusetts Institute of Technology',
                '国家': '美国',
                '州省': '马萨诸塞州',
                '城市': '剑桥',
                '排名': 1,
                '录取率': 0.07,
                '学费': 53790,
                '开设专业': ['计算机科学', '电子工程', '机械工程', '物理学', '数学'],
                '申请要求': {
                    'GPA': 3.9,
                    'TOEFL': 100,
                    'GRE': {'V': 155, 'Q': 165, 'W': 4.0}
                }
            },
            {
                '名称': '斯坦福大学',
                '英文名称': 'Stanford University',
                '国家': '美国',
                '州省': '加利福尼亚州',
                '城市': '斯坦福',
                '排名': 2,
                '录取率': 0.04,
                '学费': 52857,
                '开设专业': ['计算机科学', '商业管理', '心理学', '生物学', '工程学'],
                '申请要求': {
                    'GPA': 3.8,
                    'TOEFL': 100,
                    'GRE': {'V': 155, 'Q': 165, 'W': 4.0}
                }
            }
        ]
        
        for 大学数据 in 大学列表:
            大学实例 = 大学(
                名称=大学数据['名称'],
                英文名称=大学数据['英文名称'],
                国家=大学数据['国家'],
                州省=大学数据['州省'],
                城市=大学数据['城市'],
                排名=大学数据['排名'],
                录取率=大学数据['录取率'],
                学费=大学数据['学费'],
                开设专业=大学数据['开设专业'],
                申请要求=大学数据['申请要求']
            )
            db.session.add(大学实例)
        
        # 提交所有更改
        db.session.commit()

if __name__ == '__main__':
    初始化数据库()
    print('数据库初始化完成！')
